<?xml version="1.0" encoding="UTF-8"?>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/XHtml.xhtml to edit this template
-->
<!DOCTYPE html>
<html 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <title>CRM Clients</title>
        <meta 
            name="viewport" 
            content="width=device-width, initial-scale=1.0"/>
    </h:head>
    <h:body>
        <h:form 
            id="tableInf">
            <ui:include 
                src="/components/common/toolbar.xhtml"/>
            <p:growl 
                id="growl" 
                showDetail="true" />
            <p:dataTable 
                id="dt-clients" 
                widgetVar="dtClients" 
                paginator="true" 
                rows="5"
                paginatorPosition="bottom" 
                value="#{clientController.clients}"
                var="client"
                rowKey="#{client.id}">

                <f:facet 
                    name="header">
                    <div 
                        class="clients-table-header" 
                        style="display: flex;
                        align-items: center;
                        justify-content: space-between">
                        <span 
                            style="font-weight: bold">CLIENTS</span>
                    </div>
                </f:facet>

                <p:column 
                    headerText="NAME" 
                    sortBy="#{client.client.clientName}">
                    <h:outputText value="#{client.client.clientName}"/>
                </p:column>
                <p:column 
                    headerText="LAST NAME" 
                    sortBy="#{client.client.clientLastName}">
                    <h:outputText value="#{client.client.clientLastName}"/>
                </p:column>
                <p:column                     
                    ariaHeaderText="Actions">

                    <p:commandButton  
                        icon="pi pi-search"
                        update=":tableInf:dt-clients :dialogs:inputDialog"
                        oncomplete="PF('manageClientDialog').show()"
                        style="margin-right: .5rem"
                        styleClass="edit-button rounded-button ui-button-plain">
                        <f:setPropertyActionListener 
                            value="#{client}" 
                            target="#{clientController.selectedClient}"/>
                    </p:commandButton>
                    <p:commandButton 
                        class="ui-button-warning rounded-button" 
                        icon="pi pi-trash"
                        process="@this"
                        style="margin-right: .5rem"
                        oncomplete="PF('deleteClientDialog').show()">
                        <f:setPropertyActionListener 
                            value="#{client}" 
                            target="#{clientController.selectedClient}"/>
                    </p:commandButton>
                </p:column>

            </p:dataTable>
        </h:form>
        <h:form 
            id="dialogs">
            <p:dialog
                id="inputDialog"
                header="Client detail"
                showEffect="fade"
                widgetVar="manageClientDialog"
                responsive="true"
                modal="true">
                <p:outputPanel 
                    id="manage-client-content">
                    <p:outputPanel 
                        rendered="#{not empty clientController.selectedClient}">
                        <h:panelGrid 
                            id="evenDetails"
                            columns="2"
                            cellpadding="7">
                            <p:outputLabel 
                                for="dateC" 
                                value="Date"/>
                            <p:inplace>
                                <p:datePicker 
                                    id="dateC" 
                                    style="width:auto" 
                                    required="true"
                                    timeInput="true"
                                    value="#{clientController.selectedClient.date}"/>
                            </p:inplace>

                            <p:outputLabel 
                                for="name1">Name</p:outputLabel>
                            <p:inplace>
                                <p:inputText 
                                    id="name1"
                                    value="#{clientController.selectedClient.firName}"
                                    required="true"/>
                            </p:inplace>

                            <p:outputLabel 
                                for="days1">Days</p:outputLabel>
                            <p:inplace>
                                <p:inputText 
                                    id="days1"
                                    value="#{clientController.selectedClient.days}"
                                    required="true"/>
                            </p:inplace>
                        </h:panelGrid>
                    </p:outputPanel>
                </p:outputPanel>
                <f:facet 
                    name="footer">
                    <p:commandButton 
                        value="Save"
                        icon="pi pi-check"
                        actionListener="#{clientController.saveClient}"
                        update="manage-client-content :tableInf:dt-clients"
                        process="manage-client-content @this"
                        onclick="PF('manageClientDialog').hide()"/>

                    <p:commandButton 
                        value="Cancel"
                        icon="pi pi-times"
                        onclick="PF('manageClientDialog').hide()"
                        styleClass="ui-button-danger"
                        type="button"/>
                </f:facet>
            </p:dialog>
            <p:confirmDialog 
                widgetVar="deleteClientDialog" 
                showEffect="fade" 
                width="300" 
                message="Delete client?"
                header="Confirm"
                severity="warn">
                <p:commandButton 
                    value="Yes"
                    icon="pi pi-check"
                    styleClass="rounded-button ui-button-primary"
                    actionListener="#{clientController.deleteClient}"
                    process="@this"
                    update=":tableInf:dt-clients"
                    oncomplete="PF('deleteClientDialog').hide()"/>
                <p:commandButton 
                    value="No" 
                    icon="pi pi-times" 
                    styleClass="rounded-button ui-button-danger"
                    onclick="PF('deleteClientDialog').hide()"/>
            </p:confirmDialog>
        </h:form>
    </h:body>
</html>